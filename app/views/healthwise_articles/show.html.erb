<%
meta title: "COVID-INFORMED - Healthwise: #{@healthwise_article.en_title}",
     description: "covid-informed",
     keywords: %w(free html5, free template, free bootstrap, html5, css3, mobile first, responsive)
%>
<% content_for :head do %>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-Q8T209GGMN', {'custom_map': {'dimension1': 'rct'}, 'user_id': rct });
    gtag('event','pageview', {'rct': rct});
    gtag('send','event','eventCategory','eventAction');
  </script>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MB92CN2"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
<% end %>

<% if @healthwise_article.article_or_topic == "Article" %>
  <%= render 'hw_article', healthwise_article: @healthwise_article %>
<% else %>
  <%= render 'hw_topic', healthwise_article: @healthwise_article %>
<% end %>


<!-- like buttons -->
<section>
  <div class="container">
    <div class="row">
      <div class="col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 text-center">

      <%= form_with model: [ @healthwise_article, @healthwise_article.likes.build ] do |form| %>
        <div class="field col-md-6">
          <%= form.label :up, class: 'sr-only' %>
          <%= form.hidden_field :up, value: 1 %>
          <%= form.button @up_likes, id: "uplike", class: "ti-thumb-up btn btn-primary btn-lg fh5co-btn-icon", value: @up_likes %>
        </div>
      <% end %>

      <%= form_with model: [ @healthwise_article, @healthwise_article.likes.build ] do |form| %>
        <div class="field col-md-6">
          <%= form.label :down, class: 'sr-only' %>
          <%= form.hidden_field :down, value: 1 %>
          <%= form.button @down_likes, id: "downlike", class: "ti-thumb-down btn btn-primary btn-lg fh5co-btn-icon", value: @down_likes %>
        </div>
      <% end %>

      </div>
    </div>
    <% if current_user.try(:admin?) %>
    <div class="row">
      <div class="col-md-12 Admin-border">
        <h1 class="text-center">Likes Admin View</h1>

        <table class="col-md-10 col-md-offset-1">
          <thead>
            <tr>
              <th>Created at</th>
              <th>RCT</th>
              <th>UP</th>
              <th>Down</th>
              <th colspan="1"></th>
            </tr>
          </thead>

          <tbody>
            <% @likes.each do |like| %>
            <tr>
              <td><%= like.created_at %></td>
              <td><%= like.rct %></td>
              <td><%= like.up %></td>
              <td><%= like.down %></td>
              <td><%= link_to 'Destroy', [@healthwise_article, like], method: :delete, data: { confirm: 'Are you sure?' } %></td>
            </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
    <div class="col-md-8 col-md-offset-2">
      <%= link_to 'Export Likes to CSV', healthwise_article_path(format: "csv", format_data: "likes"), class: "btn btn-primary btn-lg btn-block"  %>
    </div>
    <% end %>
    <div class="fh5co-spacer fh5co-spacer-md"></div>
  </div>
</section>

<%= link_to 'Edit', edit_healthwise_article_path(@healthwise_article) %> |
<%= link_to 'Back', healthwise_articles_path %>
